---
layout: default
---

<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
    <form method="POST" action="javascript:login_user()">
        <center>
            <p><label>
                Username:
                <input type="text" name="username" id="username" required>
            </label></p>
            <p><label>
                Password:
                <input type="password" name="password" id="password" required>
            </label></p>
            <p><button>Login</button></p>
            <p id="message"></p>
        </center>
    </form>

    <button onclick="test()">send cookie</button>
</body>
</html>


<script>

    function test() {

        //console.log("abcc".match(/(a|b)/));

        console.log(document.cookie);

        let value = document.cookie + ";";
        let expression = value.match(/(session=.*; |; session=.*;$|; session=.*; )/);
        console.log(expression);

        //could be useful
        /*
        let value = "; " + document.cookie + ";";
        console.log(value);
        let parts = value.split("; session=");
        console.log("parts: " + parts);
        if (parts.length === 2) {
            parts = parts.pop().split(';').shift();
        }
        console.log("final: " + parts);
        */
        
    }


    function login_user() {


        var baseurl = "https://taylorswifties.duckdns.org/api/users/login";

       
        const body = {
            username: "a",
            password: "a",

        };

       

        // Set Headers to support cross origin
        //IMPORTANT!!!!!!! TO SUCCESSFULLY POST, YOU NEED TO REMOVE
        // credentials:'include'
        const requestOptions = {
            method: 'POST',
            mode: 'cors', // no-cors, *cors, same-origin
            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
            //credentials: 'include', // include, *same-origin, omit
            body: JSON.stringify(body),
            headers: {
                "content-type": "application/json"
            },
        };

        // Fetch JWT
        /*
        fetch(login_url, requestOptions);
        */

        // Fetch JWT
            fetch(baseurl, requestOptions)
            .then(response => {
                // trap error response from Web API
                if (!response.ok) {
                    const errorMsg = 'Login error: ' + response.status;
                    console.log(errorMsg);

                    if (response.status == 400) {
                        console.log("Incorrect username or password");
                    }
                
                    return;
                }

                response.json().then(data => {


                console.log(data);

                document.cookie = "session=" + data["id"];

                })


               

                //window.location.href = "{{ site.baseurl }}/homepage";
            })


      

    }  


</script>
